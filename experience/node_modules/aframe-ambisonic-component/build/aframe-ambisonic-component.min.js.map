{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./node_modules/omnitone/build/omnitone.esm.js","webpack:///./src/log.js","webpack:///./src/ambisonic-audio.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","AFRAME","Error","require","Utils","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","log","message","Array","slice","arguments","join","performance","now","toFixed","window","console","throw","invertMatrix4","out","a","isDefinedENUMEntry","enumDictionary","entryValue","enumKey","isAudioContext","context","AudioContext","OfflineAudioContext","isAudioBuffer","audioBuffer","AudioBuffer","mergeBufferListByChannel","bufferList","bufferLength","length","bufferSampleRate","sampleRate","bufferNumberOfChannel","numberOfChannels","buffer","createBuffer","destinationChannelIndex","j","getChannelData","set","splitBufferbyChannel","splitBy","sourceChannelIndex","numberOfSplittedBuffer","Math","ceil","getArrayBufferFromBase64String","base64String","binaryString","atob","byteArray","Uint8Array","forEach","index","charCodeAt","BufferDataType","BASE64","URL","BufferList","bufferData","options","this","_context","_options","dataType","verbose","Boolean","_bufferList","_bufferData","_numberOfTasks","_resolveHandler","_rejectHandler","Function","load","Promise","_promiseGenerator","resolve","reject","_launchAsyncLoadTask","_launchAsyncLoadTaskXHR","taskId","that","decodeAudioData","_updateProgress","errorMessage","xhr","XMLHttpRequest","open","responseType","onload","status","response","statusText","onerror","event","send","messageString","ChannelMap","DEFAULT","SAFARI","FUMA","FOARouter","channelMap","_splitter","createChannelSplitter","_merger","createChannelMerger","input","output","setChannelMap","FOARotator","_inY","createGain","_inZ","_inX","_m0","_m1","_m2","_m3","_m4","_m5","_m6","_m7","_m8","_outY","_outZ","_outX","connect","gain","setRotationMatrix3","Float32Array","FOAConvolver","hrirBufferList","_active","_isBufferLoaded","_buildAudioGraph","setHRIRBufferList","enable","isArray","_channelMap","disconnect","rotationMatrix3","setRotationMatrix4","rotationMatrix4","getRotationMatrix3","getRotationMatrix4","_splitterWYZX","_mergerWY","_mergerZX","_convolverWY","createConvolver","_convolverZX","_splitterWY","_splitterZX","_inverter","_mergerBinaural","_summingBus","normalize","disable","OmnitoneFOAHrirBase64","RenderingMode","AMBISONIC","BYPASS","OFF","FOARenderer","config","_config","renderingMode","hrirPathList","pathList","values","includes","_tempMatrix4","_isRendererReady","HOAConvolver","ambisonicOrder","_ambisonicOrder","_numberOfChannels","getKroneckerDelta","setCenteredElement","matrix","gainValue","getCenteredElement","getP","b","getU","getV","sqrt","getW","computeUVWCoeff","reciprocalDenominator","abs","computeBandRotation","uvwCoefficients","computeHOAMatrices","HOARotator","orderOffset","rows","inputIndex","outputIndex","matrixIndex","_gainNodeMatrix","k","_bypass","_foaRouter","_foaRotator","_foaConvolver","channelCount","channelCountMode","channelInterpretation","_initializeCallback","then","setRenderingMode","initialize","toString","setRotationMatrixFromCamera","cameraMatrix","elements","numberOfStereoChannels","_inputSplitter","_stereoMergers","_convolvers","_stereoSplitters","_positiveIndexSphericalHarmonics","_negativeIndexSphericalHarmonics","_binauralMerger","_outputGain","acnIndex","stereoIndex","floor","getAmbisonicOrder","OmnitoneTOAHrirBase64","OmnitoneSOAHrirBase64","RenderingMode$1","SupportedAmbisonicOrder","HOARenderer","_hoaRotator","_hoaConvolver","Polyfill","ua","navigator","userAgent","tem","M","match","test","exec","version","appName","appVersion","splice","platform","webkitAudioContext","webkitOfflineAudioContext","Omnitone","browserInfo","getBrowserInfo","createBufferList","createFOAConvolver","createFOARouter","createFOARotator","createHOARotator","createHOAConvolver","createFOARenderer","createHOARenderer","toLowerCase","patchSafari","warn","THREE","setBooleanAttribute","element","attr","setAttribute","removeAttribute","order","orderPlus1","boundMethods","channelMapSchemes","sid","fuma","intArrayRegex","registerComponent","schema","src","type","sources","default","loop","autoplay","useMediaElement","parse","str","trim","split","map","parseFloat","stringify","oneOf","init","renderer","audio","mediaElement","audioSources","loading","ownMediaElement","playing","el","addEventListener","onEntityChange","update","oldData","sceneEl","listener","audioListener","getContext","camera","setCamera","data","channels","rebuildOmnitone","resumeAudioContext","createRenderer","destination","updateAmbisonicSettings","Audio","getInput","JSON","newMediaElement","HTMLMediaElement","document","createElement","cleanMediaAssets","onPlaySound","onPauseSound","onLoadSound","onEndSound","evt","onloadedmetadata","setMediaElementSource","source","url","tagName","srcObject","currentSrc","loadBuffer","updatePlaybackSettings","tick","matrixWorldInverse","play","playSound","pause","pauseSound","removeEventListener","isPlaying","stop","sourceType","remove","detail","cameraEl","getObject3D","resume","state","catch","results","setBuffer","error","playPromise","e","stopSound","emit","setLoop","object3D","updateMatrixWorld","registerPrimitive","defaultComponents","mappings"],"mappings":"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","file":"aframe-ambisonic-component.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* global AFRAME */\nif (typeof AFRAME === 'undefined') {\n\tthrow new Error('Component attempted to register before AFRAME was available. Did you include A-Frame?');\n}\n\nif (module.hot) {\n\tmodule.hot.accept();\n}\n\nrequire('./ambisonic-audio');\n","/**\n * @license\n * Copyright 2016 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst Utils = {};\nUtils.log = function() {\n  const message = `[Omnitone] \\\n${Array.prototype.slice.call(arguments).join(' ')} \\\n(${performance.now().toFixed(2)}ms)`;\n  window.console.log(message);\n};\nUtils.throw = function() {\n  const message = `[Omnitone] \\\n${Array.prototype.slice.call(arguments).join(' ')} \\\n(${performance.now().toFixed(2)}ms)`;\n  throw new Error(message);\n};\nlet a00;\nlet a01;\nlet a02;\nlet a03;\nlet a10;\nlet a11;\nlet a12;\nlet a13;\nlet a20;\nlet a21;\nlet a22;\nlet a23;\nlet a30;\nlet a31;\nlet a32;\nlet a33;\nlet b00;\nlet b01;\nlet b02;\nlet b03;\nlet b04;\nlet b05;\nlet b06;\nlet b07;\nlet b08;\nlet b09;\nlet b10;\nlet b11;\nlet det;\nUtils.invertMatrix4 = function(out, a) {\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11];\n  a30 = a[12];\n  a31 = a[13];\n  a32 = a[14];\n  a33 = a[15];\n  b00 = a00 * a11 - a01 * a10;\n  b01 = a00 * a12 - a02 * a10;\n  b02 = a00 * a13 - a03 * a10;\n  b03 = a01 * a12 - a02 * a11;\n  b04 = a01 * a13 - a03 * a11;\n  b05 = a02 * a13 - a03 * a12;\n  b06 = a20 * a31 - a21 * a30;\n  b07 = a20 * a32 - a22 * a30;\n  b08 = a20 * a33 - a23 * a30;\n  b09 = a21 * a32 - a22 * a31;\n  b10 = a21 * a33 - a23 * a31;\n  b11 = a22 * a33 - a23 * a32;\n  det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n};\nUtils.isDefinedENUMEntry = function(enumDictionary, entryValue) {\n  for (const enumKey in enumDictionary) {\n    if (entryValue === enumDictionary[enumKey]) {\n      return true;\n    }\n  }\n  return false;\n};\nUtils.isAudioContext = function(context) {\n  return context instanceof AudioContext ||\n    context instanceof OfflineAudioContext;\n};\nUtils.isAudioBuffer = function(audioBuffer) {\n  return audioBuffer instanceof AudioBuffer;\n};\nUtils.mergeBufferListByChannel = function(context, bufferList) {\n  const bufferLength = bufferList[0].length;\n  const bufferSampleRate = bufferList[0].sampleRate;\n  let bufferNumberOfChannel = 0;\n  for (let i = 0; i < bufferList.length; ++i) {\n    if (bufferNumberOfChannel > 32) {\n      Utils.throw('Utils.mergeBuffer: Number of channels cannot exceed 32.' +\n          '(got ' + bufferNumberOfChannel + ')');\n    }\n    if (bufferLength !== bufferList[i].length) {\n      Utils.throw('Utils.mergeBuffer: AudioBuffer lengths are ' +\n          'inconsistent. (expected ' + bufferLength + ' but got ' +\n          bufferList[i].length + ')');\n    }\n    if (bufferSampleRate !== bufferList[i].sampleRate) {\n      Utils.throw('Utils.mergeBuffer: AudioBuffer sample rates are ' +\n          'inconsistent. (expected ' + bufferSampleRate + ' but got ' +\n          bufferList[i].sampleRate + ')');\n    }\n    bufferNumberOfChannel += bufferList[i].numberOfChannels;\n  }\n  const buffer = context.createBuffer(\n      bufferNumberOfChannel, bufferLength, bufferSampleRate);\n  let destinationChannelIndex = 0;\n  for (let i = 0; i < bufferList.length; ++i) {\n    for (let j = 0; j < bufferList[i].numberOfChannels; ++j) {\n      buffer.getChannelData(destinationChannelIndex++).set(\n          bufferList[i].getChannelData(j));\n    }\n  }\n  return buffer;\n};\nUtils.splitBufferbyChannel = function(context, audioBuffer, splitBy) {\n  if (audioBuffer.numberOfChannels <= splitBy) {\n    Utils.throw('Utils.splitBuffer: Insufficient number of channels. (' +\n        audioBuffer.numberOfChannels + ' splitted by ' + splitBy + ')');\n  }\n  let sourceChannelIndex = 0;\n  const numberOfSplittedBuffer =\n      Math.ceil(audioBuffer.numberOfChannels / splitBy);\n  for (let i = 0; i < numberOfSplittedBuffer; ++i) {\n    const buffer = context.createBuffer(\n        splitBy, audioBuffer.length, audioBuffer.sampleRate);\n    for (let j = 0; j < splitBy; ++j) {\n      if (sourceChannelIndex < audioBuffer.numberOfChannels) {\n        buffer.getChannelData(j).set(\n            audioBuffer.getChannelData(sourceChannelIndex++));\n      }\n    }\n  }\n  return bufferList;\n};\nUtils.getArrayBufferFromBase64String = function(base64String) {\n  const binaryString = window.atob(base64String);\n  const byteArray = new Uint8Array(binaryString.length);\n  byteArray.forEach(\n      (value, index) => byteArray[index] = binaryString.charCodeAt(index));\n  return byteArray.buffer;\n};\n\nconst BufferDataType = {\n  BASE64: 'base64',\n  URL: 'url',\n};\nfunction BufferList(context, bufferData, options) {\n  this._context = Utils.isAudioContext(context) ?\n      context :\n      Utils.throw('BufferList: Invalid BaseAudioContext.');\n  this._options = {\n    dataType: BufferDataType.BASE64,\n    verbose: false,\n  };\n  if (options) {\n    if (options.dataType &&\n        Utils.isDefinedENUMEntry(BufferDataType, options.dataType)) {\n      this._options.dataType = options.dataType;\n    }\n    if (options.verbose) {\n      this._options.verbose = Boolean(options.verbose);\n    }\n  }\n  this._bufferList = [];\n  this._bufferData = this._options.dataType === BufferDataType.BASE64\n      ? bufferData\n      : bufferData.slice(0);\n  this._numberOfTasks = this._bufferData.length;\n  this._resolveHandler = null;\n  this._rejectHandler = new Function();\n}\nBufferList.prototype.load = function() {\n  return new Promise(this._promiseGenerator.bind(this));\n};\nBufferList.prototype._promiseGenerator = function(resolve, reject) {\n  if (typeof resolve !== 'function') {\n    Utils.throw('BufferList: Invalid Promise resolver.');\n  } else {\n    this._resolveHandler = resolve;\n  }\n  if (typeof reject === 'function') {\n    this._rejectHandler = reject;\n  }\n  for (let i = 0; i < this._bufferData.length; ++i) {\n    this._options.dataType === BufferDataType.BASE64\n        ? this._launchAsyncLoadTask(i)\n        : this._launchAsyncLoadTaskXHR(i);\n  }\n};\nBufferList.prototype._launchAsyncLoadTask = function(taskId) {\n  const that = this;\n  this._context.decodeAudioData(\n      Utils.getArrayBufferFromBase64String(this._bufferData[taskId]),\n      function(audioBuffer) {\n        that._updateProgress(taskId, audioBuffer);\n      },\n      function(errorMessage) {\n        that._updateProgress(taskId, null);\n        const message = 'BufferList: decoding ArrayByffer(\"' + taskId +\n            '\" from Base64-encoded data failed. (' + errorMessage + ')';\n        that._rejectHandler(message);\n        Utils.throw(message);\n      });\n};\nBufferList.prototype._launchAsyncLoadTaskXHR = function(taskId) {\n  const xhr = new XMLHttpRequest();\n  xhr.open('GET', this._bufferData[taskId]);\n  xhr.responseType = 'arraybuffer';\n  const that = this;\n  xhr.onload = function() {\n    if (xhr.status === 200) {\n      that._context.decodeAudioData(\n          xhr.response,\n          function(audioBuffer) {\n            that._updateProgress(taskId, audioBuffer);\n          },\n          function(errorMessage) {\n            that._updateProgress(taskId, null);\n            const message = 'BufferList: decoding \"' +\n                that._bufferData[taskId] + '\" failed. (' + errorMessage + ')';\n            that._rejectHandler(message);\n            Utils.log(message);\n          });\n    } else {\n      const message = 'BufferList: XHR error while loading \"' +\n          that._bufferData[taskId] + '\". (' + xhr.status + ' ' +\n          xhr.statusText + ')';\n      that._rejectHandler(message);\n      Utils.log(message);\n    }\n  };\n  xhr.onerror = function(event) {\n    that._updateProgress(taskId, null);\n    that._rejectHandler();\n    Utils.log(\n        'BufferList: XHR network failed on loading \"' +\n        that._bufferData[taskId] + '\".');\n  };\n  xhr.send();\n};\nBufferList.prototype._updateProgress = function(taskId, audioBuffer) {\n  this._bufferList[taskId] = audioBuffer;\n  if (this._options.verbose) {\n    const messageString = this._options.dataType === BufferDataType.BASE64\n        ? 'ArrayBuffer(' + taskId + ') from Base64-encoded HRIR'\n        : '\"' + this._bufferData[taskId] + '\"';\n    Utils.log('BufferList: ' + messageString + ' successfully loaded.');\n  }\n  if (--this._numberOfTasks === 0) {\n    const messageString = this._options.dataType === BufferDataType.BASE64\n        ? this._bufferData.length + ' AudioBuffers from Base64-encoded HRIRs'\n        : this._bufferData.length + ' files via XHR';\n    Utils.log('BufferList: ' + messageString + ' loaded successfully.');\n    this._resolveHandler(this._bufferList);\n  }\n};\n\nconst ChannelMap = {\n  DEFAULT: [0, 1, 2, 3],\n  SAFARI: [2, 0, 1, 3],\n  FUMA: [0, 3, 1, 2],\n};\nfunction FOARouter(context, channelMap) {\n  this._context = context;\n  this._splitter = this._context.createChannelSplitter(4);\n  this._merger = this._context.createChannelMerger(4);\n  this.input = this._splitter;\n  this.output = this._merger;\n  this.setChannelMap(channelMap || ChannelMap.DEFAULT);\n}\nFOARouter.prototype.setChannelMap = function(channelMap) {\n  if (!Array.isArray(channelMap)) {\n    return;\n  }\n  this._channelMap = channelMap;\n  this._splitter.disconnect();\n  this._splitter.connect(this._merger, 0, this._channelMap[0]);\n  this._splitter.connect(this._merger, 1, this._channelMap[1]);\n  this._splitter.connect(this._merger, 2, this._channelMap[2]);\n  this._splitter.connect(this._merger, 3, this._channelMap[3]);\n};\nFOARouter.ChannelMap = ChannelMap;\n\nfunction FOARotator(context) {\n  this._context = context;\n  this._splitter = this._context.createChannelSplitter(4);\n  this._inY = this._context.createGain();\n  this._inZ = this._context.createGain();\n  this._inX = this._context.createGain();\n  this._m0 = this._context.createGain();\n  this._m1 = this._context.createGain();\n  this._m2 = this._context.createGain();\n  this._m3 = this._context.createGain();\n  this._m4 = this._context.createGain();\n  this._m5 = this._context.createGain();\n  this._m6 = this._context.createGain();\n  this._m7 = this._context.createGain();\n  this._m8 = this._context.createGain();\n  this._outY = this._context.createGain();\n  this._outZ = this._context.createGain();\n  this._outX = this._context.createGain();\n  this._merger = this._context.createChannelMerger(4);\n  this._splitter.connect(this._inY, 1);\n  this._splitter.connect(this._inZ, 2);\n  this._splitter.connect(this._inX, 3);\n  this._inY.gain.value = -1;\n  this._inX.gain.value = -1;\n  this._inY.connect(this._m0);\n  this._inY.connect(this._m1);\n  this._inY.connect(this._m2);\n  this._inZ.connect(this._m3);\n  this._inZ.connect(this._m4);\n  this._inZ.connect(this._m5);\n  this._inX.connect(this._m6);\n  this._inX.connect(this._m7);\n  this._inX.connect(this._m8);\n  this._m0.connect(this._outY);\n  this._m1.connect(this._outZ);\n  this._m2.connect(this._outX);\n  this._m3.connect(this._outY);\n  this._m4.connect(this._outZ);\n  this._m5.connect(this._outX);\n  this._m6.connect(this._outY);\n  this._m7.connect(this._outZ);\n  this._m8.connect(this._outX);\n  this._splitter.connect(this._merger, 0, 0);\n  this._outY.connect(this._merger, 0, 1);\n  this._outZ.connect(this._merger, 0, 2);\n  this._outX.connect(this._merger, 0, 3);\n  this._outY.gain.value = -1;\n  this._outX.gain.value = -1;\n  this.setRotationMatrix3(new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]));\n  this.input = this._splitter;\n  this.output = this._merger;\n}\nFOARotator.prototype.setRotationMatrix3 = function(rotationMatrix3) {\n  this._m0.gain.value = rotationMatrix3[0];\n  this._m1.gain.value = rotationMatrix3[1];\n  this._m2.gain.value = rotationMatrix3[2];\n  this._m3.gain.value = rotationMatrix3[3];\n  this._m4.gain.value = rotationMatrix3[4];\n  this._m5.gain.value = rotationMatrix3[5];\n  this._m6.gain.value = rotationMatrix3[6];\n  this._m7.gain.value = rotationMatrix3[7];\n  this._m8.gain.value = rotationMatrix3[8];\n};\nFOARotator.prototype.setRotationMatrix4 = function(rotationMatrix4) {\n  this._m0.gain.value = rotationMatrix4[0];\n  this._m1.gain.value = rotationMatrix4[1];\n  this._m2.gain.value = rotationMatrix4[2];\n  this._m3.gain.value = rotationMatrix4[4];\n  this._m4.gain.value = rotationMatrix4[5];\n  this._m5.gain.value = rotationMatrix4[6];\n  this._m6.gain.value = rotationMatrix4[8];\n  this._m7.gain.value = rotationMatrix4[9];\n  this._m8.gain.value = rotationMatrix4[10];\n};\nFOARotator.prototype.getRotationMatrix3 = function() {\n  return [\n    this._m0.gain.value, this._m1.gain.value, this._m2.gain.value,\n    this._m3.gain.value, this._m4.gain.value, this._m5.gain.value,\n    this._m6.gain.value, this._m7.gain.value, this._m8.gain.value,\n  ];\n};\nFOARotator.prototype.getRotationMatrix4 = function() {\n  const rotationMatrix4 = new Float32Array(16);\n  rotationMatrix4[0] = this._m0.gain.value;\n  rotationMatrix4[1] = this._m1.gain.value;\n  rotationMatrix4[2] = this._m2.gain.value;\n  rotationMatrix4[4] = this._m3.gain.value;\n  rotationMatrix4[5] = this._m4.gain.value;\n  rotationMatrix4[6] = this._m5.gain.value;\n  rotationMatrix4[8] = this._m6.gain.value;\n  rotationMatrix4[9] = this._m7.gain.value;\n  rotationMatrix4[10] = this._m8.gain.value;\n  return rotationMatrix4;\n};\n\nfunction FOAConvolver(context, hrirBufferList) {\n  this._context = context;\n  this._active = false;\n  this._isBufferLoaded = false;\n  this._buildAudioGraph();\n  if (hrirBufferList) {\n    this.setHRIRBufferList(hrirBufferList);\n  }\n  this.enable();\n}\nFOAConvolver.prototype._buildAudioGraph = function() {\n  this._splitterWYZX = this._context.createChannelSplitter(4);\n  this._mergerWY = this._context.createChannelMerger(2);\n  this._mergerZX = this._context.createChannelMerger(2);\n  this._convolverWY = this._context.createConvolver();\n  this._convolverZX = this._context.createConvolver();\n  this._splitterWY = this._context.createChannelSplitter(2);\n  this._splitterZX = this._context.createChannelSplitter(2);\n  this._inverter = this._context.createGain();\n  this._mergerBinaural = this._context.createChannelMerger(2);\n  this._summingBus = this._context.createGain();\n  this._splitterWYZX.connect(this._mergerWY, 0, 0);\n  this._splitterWYZX.connect(this._mergerWY, 1, 1);\n  this._splitterWYZX.connect(this._mergerZX, 2, 0);\n  this._splitterWYZX.connect(this._mergerZX, 3, 1);\n  this._mergerWY.connect(this._convolverWY);\n  this._mergerZX.connect(this._convolverZX);\n  this._convolverWY.connect(this._splitterWY);\n  this._convolverZX.connect(this._splitterZX);\n  this._splitterWY.connect(this._mergerBinaural, 0, 0);\n  this._splitterWY.connect(this._mergerBinaural, 0, 1);\n  this._splitterWY.connect(this._mergerBinaural, 1, 0);\n  this._splitterWY.connect(this._inverter, 1, 0);\n  this._inverter.connect(this._mergerBinaural, 0, 1);\n  this._splitterZX.connect(this._mergerBinaural, 0, 0);\n  this._splitterZX.connect(this._mergerBinaural, 0, 1);\n  this._splitterZX.connect(this._mergerBinaural, 1, 0);\n  this._splitterZX.connect(this._mergerBinaural, 1, 1);\n  this._convolverWY.normalize = false;\n  this._convolverZX.normalize = false;\n  this._inverter.gain.value = -1;\n  this.input = this._splitterWYZX;\n  this.output = this._summingBus;\n};\nFOAConvolver.prototype.setHRIRBufferList = function(hrirBufferList) {\n  if (this._isBufferLoaded) {\n    return;\n  }\n  this._convolverWY.buffer = hrirBufferList[0];\n  this._convolverZX.buffer = hrirBufferList[1];\n  this._isBufferLoaded = true;\n};\nFOAConvolver.prototype.enable = function() {\n  this._mergerBinaural.connect(this._summingBus);\n  this._active = true;\n};\nFOAConvolver.prototype.disable = function() {\n  this._mergerBinaural.disconnect();\n  this._active = false;\n};\n\nconst OmnitoneFOAHrirBase64 = [\n\"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\",\n];\n\nconst RenderingMode = {\n  AMBISONIC: 'ambisonic',\n  BYPASS: 'bypass',\n  OFF: 'off',\n};\nfunction FOARenderer(context, config) {\n  this._context = Utils.isAudioContext(context) ?\n      context :\n      Utils.throw('FOARenderer: Invalid BaseAudioContext.');\n  this._config = {\n    channelMap: FOARouter.ChannelMap.DEFAULT,\n    renderingMode: RenderingMode.AMBISONIC,\n  };\n  if (config) {\n    if (config.channelMap) {\n      if (Array.isArray(config.channelMap) && config.channelMap.length === 4) {\n        this._config.channelMap = config.channelMap;\n      } else {\n        Utils.throw(\n            'FOARenderer: Invalid channel map. (got ' + config.channelMap\n            + ')');\n      }\n    }\n    if (config.hrirPathList) {\n      if (Array.isArray(config.hrirPathList) &&\n          config.hrirPathList.length === 2) {\n        this._config.pathList = config.hrirPathList;\n      } else {\n        Utils.throw(\n            'FOARenderer: Invalid HRIR URLs. It must be an array with ' +\n            '2 URLs to HRIR files. (got ' + config.hrirPathList + ')');\n      }\n    }\n    if (config.renderingMode) {\n      if (Object.values(RenderingMode).includes(config.renderingMode)) {\n        this._config.renderingMode = config.renderingMode;\n      } else {\n        Utils.log(\n            'FOARenderer: Invalid rendering mode order. (got' +\n            config.renderingMode + ') Fallbacks to the mode \"ambisonic\".');\n      }\n    }\n  }\n  this._buildAudioGraph();\n  this._tempMatrix4 = new Float32Array(16);\n  this._isRendererReady = false;\n}\nFOARenderer.prototype._buildAudioGraph = function() {\n  this.input = this._context.createGain();\n  this.output = this._context.createGain();\n  this._bypass = this._context.createGain();\n  this._foaRouter = new FOARouter(this._context, this._config.channelMap);\n  this._foaRotator = new FOARotator(this._context);\n  this._foaConvolver = new FOAConvolver(this._context);\n  this.input.connect(this._foaRouter.input);\n  this.input.connect(this._bypass);\n  this._foaRouter.output.connect(this._foaRotator.input);\n  this._foaRotator.output.connect(this._foaConvolver.input);\n  this._foaConvolver.output.connect(this.output);\n  this.input.channelCount = 4;\n  this.input.channelCountMode = 'explicit';\n  this.input.channelInterpretation = 'discrete';\n};\nFOARenderer.prototype._initializeCallback = function(resolve, reject) {\n  const bufferList = this._config.pathList\n      ? new BufferList(this._context, this._config.pathList, {dataType: 'url'})\n      : new BufferList(this._context, OmnitoneFOAHrirBase64);\n  bufferList.load().then(\n      function(hrirBufferList) {\n        this._foaConvolver.setHRIRBufferList(hrirBufferList);\n        this.setRenderingMode(this._config.renderingMode);\n        this._isRendererReady = true;\n        Utils.log('FOARenderer: HRIRs loaded successfully. Ready.');\n        resolve();\n      }.bind(this),\n      function() {\n        const errorMessage = 'FOARenderer: HRIR loading/decoding failed.';\n        reject(errorMessage);\n        Utils.throw(errorMessage);\n      });\n};\nFOARenderer.prototype.initialize = function() {\n  Utils.log(\n      'FOARenderer: Initializing... (mode: ' + this._config.renderingMode +\n      ')');\n  return new Promise(this._initializeCallback.bind(this));\n};\nFOARenderer.prototype.setChannelMap = function(channelMap) {\n  if (!this._isRendererReady) {\n    return;\n  }\n  if (channelMap.toString() !== this._config.channelMap.toString()) {\n    Utils.log(\n        'Remapping channels ([' + this._config.channelMap.toString() +\n        '] -> [' + channelMap.toString() + ']).');\n    this._config.channelMap = channelMap.slice();\n    this._foaRouter.setChannelMap(this._config.channelMap);\n  }\n};\nFOARenderer.prototype.setRotationMatrix3 = function(rotationMatrix3) {\n  if (!this._isRendererReady) {\n    return;\n  }\n  this._foaRotator.setRotationMatrix3(rotationMatrix3);\n};\nFOARenderer.prototype.setRotationMatrix4 = function(rotationMatrix4) {\n  if (!this._isRendererReady) {\n    return;\n  }\n  this._foaRotator.setRotationMatrix4(rotationMatrix4);\n};\nFOARenderer.prototype.setRotationMatrixFromCamera = function(cameraMatrix) {\n  if (!this._isRendererReady) {\n    return;\n  }\n  Utils.invertMatrix4(this._tempMatrix4, cameraMatrix.elements);\n  this._foaRotator.setRotationMatrix4(this._tempMatrix4);\n};\nFOARenderer.prototype.setRenderingMode = function(mode) {\n  if (mode === this._config.renderingMode) {\n    return;\n  }\n  switch (mode) {\n    case RenderingMode.AMBISONIC:\n      this._foaConvolver.enable();\n      this._bypass.disconnect();\n      break;\n    case RenderingMode.BYPASS:\n      this._foaConvolver.disable();\n      this._bypass.connect(this.output);\n      break;\n    case RenderingMode.OFF:\n      this._foaConvolver.disable();\n      this._bypass.disconnect();\n      break;\n    default:\n      Utils.log(\n          'FOARenderer: Rendering mode \"' + mode + '\" is not ' +\n          'supported.');\n      return;\n  }\n  this._config.renderingMode = mode;\n  Utils.log('FOARenderer: Rendering mode changed. (' + mode + ')');\n};\n\nfunction HOAConvolver(context, ambisonicOrder, hrirBufferList) {\n  this._context = context;\n  this._active = false;\n  this._isBufferLoaded = false;\n  this._ambisonicOrder = ambisonicOrder;\n  this._numberOfChannels =\n      (this._ambisonicOrder + 1) * (this._ambisonicOrder + 1);\n  this._buildAudioGraph();\n  if (hrirBufferList) {\n    this.setHRIRBufferList(hrirBufferList);\n  }\n  this.enable();\n}\nHOAConvolver.prototype._buildAudioGraph = function() {\n  const numberOfStereoChannels = Math.ceil(this._numberOfChannels / 2);\n  this._inputSplitter =\n      this._context.createChannelSplitter(this._numberOfChannels);\n  this._stereoMergers = [];\n  this._convolvers = [];\n  this._stereoSplitters = [];\n  this._positiveIndexSphericalHarmonics = this._context.createGain();\n  this._negativeIndexSphericalHarmonics = this._context.createGain();\n  this._inverter = this._context.createGain();\n  this._binauralMerger = this._context.createChannelMerger(2);\n  this._outputGain = this._context.createGain();\n  for (let i = 0; i < numberOfStereoChannels; ++i) {\n    this._stereoMergers[i] = this._context.createChannelMerger(2);\n    this._convolvers[i] = this._context.createConvolver();\n    this._stereoSplitters[i] = this._context.createChannelSplitter(2);\n    this._convolvers[i].normalize = false;\n  }\n  for (let l = 0; l <= this._ambisonicOrder; ++l) {\n    for (let m = -l; m <= l; m++) {\n      const acnIndex = l * l + l + m;\n      const stereoIndex = Math.floor(acnIndex / 2);\n      this._inputSplitter.connect(\n          this._stereoMergers[stereoIndex], acnIndex, acnIndex % 2);\n      this._stereoMergers[stereoIndex].connect(this._convolvers[stereoIndex]);\n      this._convolvers[stereoIndex].connect(this._stereoSplitters[stereoIndex]);\n      if (m >= 0) {\n        this._stereoSplitters[stereoIndex].connect(\n            this._positiveIndexSphericalHarmonics, acnIndex % 2);\n      } else {\n        this._stereoSplitters[stereoIndex].connect(\n            this._negativeIndexSphericalHarmonics, acnIndex % 2);\n      }\n    }\n  }\n  this._positiveIndexSphericalHarmonics.connect(this._binauralMerger, 0, 0);\n  this._positiveIndexSphericalHarmonics.connect(this._binauralMerger, 0, 1);\n  this._negativeIndexSphericalHarmonics.connect(this._binauralMerger, 0, 0);\n  this._negativeIndexSphericalHarmonics.connect(this._inverter);\n  this._inverter.connect(this._binauralMerger, 0, 1);\n  this._inverter.gain.value = -1;\n  this.input = this._inputSplitter;\n  this.output = this._outputGain;\n};\nHOAConvolver.prototype.setHRIRBufferList = function(hrirBufferList) {\n  if (this._isBufferLoaded) {\n    return;\n  }\n  for (let i = 0; i < hrirBufferList.length; ++i) {\n    this._convolvers[i].buffer = hrirBufferList[i];\n  }\n  this._isBufferLoaded = true;\n};\nHOAConvolver.prototype.enable = function() {\n  this._binauralMerger.connect(this._outputGain);\n  this._active = true;\n};\nHOAConvolver.prototype.disable = function() {\n  this._binauralMerger.disconnect();\n  this._active = false;\n};\n\nfunction getKroneckerDelta(i, j) {\n  return i === j ? 1 : 0;\n}\nfunction setCenteredElement(matrix, l, i, j, gainValue) {\n  const index = (j + l) * (2 * l + 1) + (i + l);\n  matrix[l - 1][index].gain.value = gainValue;\n}\nfunction getCenteredElement(matrix, l, i, j) {\n  const index = (j + l) * (2 * l + 1) + (i + l);\n  return matrix[l - 1][index].gain.value;\n}\nfunction getP(matrix, i, a, b, l) {\n  if (b === l) {\n    return getCenteredElement(matrix, 1, i, 1) *\n        getCenteredElement(matrix, l - 1, a, l - 1) -\n        getCenteredElement(matrix, 1, i, -1) *\n        getCenteredElement(matrix, l - 1, a, -l + 1);\n  } else if (b === -l) {\n    return getCenteredElement(matrix, 1, i, 1) *\n        getCenteredElement(matrix, l - 1, a, -l + 1) +\n        getCenteredElement(matrix, 1, i, -1) *\n        getCenteredElement(matrix, l - 1, a, l - 1);\n  } else {\n    return getCenteredElement(matrix, 1, i, 0) *\n        getCenteredElement(matrix, l - 1, a, b);\n  }\n}\nfunction getU(matrix, m, n, l) {\n  return getP(matrix, 0, m, n, l);\n}\nfunction getV(matrix, m, n, l) {\n  if (m === 0) {\n    return getP(matrix, 1, 1, n, l) + getP(matrix, -1, -1, n, l);\n  } else if (m > 0) {\n    const d = getKroneckerDelta(m, 1);\n    return getP(matrix, 1, m - 1, n, l) * Math.sqrt(1 + d) -\n        getP(matrix, -1, -m + 1, n, l) * (1 - d);\n  } else {\n    const d = getKroneckerDelta(m, -1);\n    return getP(matrix, 1, m + 1, n, l) * (1 - d) +\n        getP(matrix, -1, -m - 1, n, l) * Math.sqrt(1 + d);\n  }\n}\nfunction getW(matrix, m, n, l) {\n  if (m === 0) {\n    return 0;\n  }\n  return m > 0 ? getP(matrix, 1, m + 1, n, l) + getP(matrix, -1, -m - 1, n, l) :\n                 getP(matrix, 1, m - 1, n, l) - getP(matrix, -1, -m + 1, n, l);\n}\nfunction computeUVWCoeff(m, n, l) {\n  const d = getKroneckerDelta(m, 0);\n  const reciprocalDenominator =\n      Math.abs(n) === l ? 1 / (2 * l * (2 * l - 1)) : 1 / ((l + n) * (l - n));\n  return [\n    Math.sqrt((l + m) * (l - m) * reciprocalDenominator),\n    0.5 * (1 - 2 * d) * Math.sqrt((1 + d) *\n                                  (l + Math.abs(m) - 1) *\n                                  (l + Math.abs(m)) *\n                                  reciprocalDenominator),\n    -0.5 * (1 - d) * Math.sqrt((l - Math.abs(m) - 1) * (l - Math.abs(m))) *\n        reciprocalDenominator,\n  ];\n}\nfunction computeBandRotation(matrix, l) {\n  for (let m = -l; m <= l; m++) {\n    for (let n = -l; n <= l; n++) {\n      const uvwCoefficients = computeUVWCoeff(m, n, l);\n      if (Math.abs(uvwCoefficients[0]) > 0) {\n        uvwCoefficients[0] *= getU(matrix, m, n, l);\n      }\n      if (Math.abs(uvwCoefficients[1]) > 0) {\n        uvwCoefficients[1] *= getV(matrix, m, n, l);\n      }\n      if (Math.abs(uvwCoefficients[2]) > 0) {\n        uvwCoefficients[2] *= getW(matrix, m, n, l);\n      }\n      setCenteredElement(\n          matrix, l, m, n,\n          uvwCoefficients[0] + uvwCoefficients[1] + uvwCoefficients[2]);\n    }\n  }\n}\nfunction computeHOAMatrices(matrix) {\n  for (let i = 2; i <= matrix.length; i++) {\n    computeBandRotation(matrix, i);\n  }\n}\nfunction HOARotator(context, ambisonicOrder) {\n  this._context = context;\n  this._ambisonicOrder = ambisonicOrder;\n  const numberOfChannels = (ambisonicOrder + 1) * (ambisonicOrder + 1);\n  this._splitter = this._context.createChannelSplitter(numberOfChannels);\n  this._merger = this._context.createChannelMerger(numberOfChannels);\n  this._gainNodeMatrix = [];\n  let orderOffset;\n  let rows;\n  let inputIndex;\n  let outputIndex;\n  let matrixIndex;\n  for (let i = 1; i <= ambisonicOrder; i++) {\n    orderOffset = i * i;\n    rows = (2 * i + 1);\n    this._gainNodeMatrix[i - 1] = [];\n    for (let j = 0; j < rows; j++) {\n      inputIndex = orderOffset + j;\n      for (let k = 0; k < rows; k++) {\n        outputIndex = orderOffset + k;\n        matrixIndex = j * rows + k;\n        this._gainNodeMatrix[i - 1][matrixIndex] = this._context.createGain();\n        this._splitter.connect(\n            this._gainNodeMatrix[i - 1][matrixIndex], inputIndex);\n        this._gainNodeMatrix[i - 1][matrixIndex].connect(\n            this._merger, 0, outputIndex);\n      }\n    }\n  }\n  this._splitter.connect(this._merger, 0, 0);\n  this.setRotationMatrix3(new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]));\n  this.input = this._splitter;\n  this.output = this._merger;\n}\nHOARotator.prototype.setRotationMatrix3 = function(rotationMatrix3) {\n  this._gainNodeMatrix[0][0].gain.value = -rotationMatrix3[0];\n  this._gainNodeMatrix[0][1].gain.value = rotationMatrix3[1];\n  this._gainNodeMatrix[0][2].gain.value = -rotationMatrix3[2];\n  this._gainNodeMatrix[0][3].gain.value = -rotationMatrix3[3];\n  this._gainNodeMatrix[0][4].gain.value = rotationMatrix3[4];\n  this._gainNodeMatrix[0][5].gain.value = -rotationMatrix3[5];\n  this._gainNodeMatrix[0][6].gain.value = -rotationMatrix3[6];\n  this._gainNodeMatrix[0][7].gain.value = rotationMatrix3[7];\n  this._gainNodeMatrix[0][8].gain.value = -rotationMatrix3[8];\n  computeHOAMatrices(this._gainNodeMatrix);\n};\nHOARotator.prototype.setRotationMatrix4 = function(rotationMatrix4) {\n  this._gainNodeMatrix[0][0].gain.value = -rotationMatrix4[0];\n  this._gainNodeMatrix[0][1].gain.value = rotationMatrix4[1];\n  this._gainNodeMatrix[0][2].gain.value = -rotationMatrix4[2];\n  this._gainNodeMatrix[0][3].gain.value = -rotationMatrix4[4];\n  this._gainNodeMatrix[0][4].gain.value = rotationMatrix4[5];\n  this._gainNodeMatrix[0][5].gain.value = -rotationMatrix4[6];\n  this._gainNodeMatrix[0][6].gain.value = -rotationMatrix4[8];\n  this._gainNodeMatrix[0][7].gain.value = rotationMatrix4[9];\n  this._gainNodeMatrix[0][8].gain.value = -rotationMatrix4[10];\n  computeHOAMatrices(this._gainNodeMatrix);\n};\nHOARotator.prototype.getRotationMatrix3 = function() {\n  const rotationMatrix3 = new Float32Array(9);\n  rotationMatrix3[0] = -this._gainNodeMatrix[0][0].gain.value;\n  rotationMatrix3[1] = this._gainNodeMatrix[0][1].gain.value;\n  rotationMatrix3[2] = -this._gainNodeMatrix[0][2].gain.value;\n  rotationMatrix3[4] = -this._gainNodeMatrix[0][3].gain.value;\n  rotationMatrix3[5] = this._gainNodeMatrix[0][4].gain.value;\n  rotationMatrix3[6] = -this._gainNodeMatrix[0][5].gain.value;\n  rotationMatrix3[8] = -this._gainNodeMatrix[0][6].gain.value;\n  rotationMatrix3[9] = this._gainNodeMatrix[0][7].gain.value;\n  rotationMatrix3[10] = -this._gainNodeMatrix[0][8].gain.value;\n  return rotationMatrix3;\n};\nHOARotator.prototype.getRotationMatrix4 = function() {\n  const rotationMatrix4 = new Float32Array(16);\n  rotationMatrix4[0] = -this._gainNodeMatrix[0][0].gain.value;\n  rotationMatrix4[1] = this._gainNodeMatrix[0][1].gain.value;\n  rotationMatrix4[2] = -this._gainNodeMatrix[0][2].gain.value;\n  rotationMatrix4[4] = -this._gainNodeMatrix[0][3].gain.value;\n  rotationMatrix4[5] = this._gainNodeMatrix[0][4].gain.value;\n  rotationMatrix4[6] = -this._gainNodeMatrix[0][5].gain.value;\n  rotationMatrix4[8] = -this._gainNodeMatrix[0][6].gain.value;\n  rotationMatrix4[9] = this._gainNodeMatrix[0][7].gain.value;\n  rotationMatrix4[10] = -this._gainNodeMatrix[0][8].gain.value;\n  return rotationMatrix4;\n};\nHOARotator.prototype.getAmbisonicOrder = function() {\n  return this._ambisonicOrder;\n};\n\nconst OmnitoneTOAHrirBase64 = [\n\"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AAD7/wEAAgD7//7/AQD8/wAAAwD8//3/AwD9/wAAAgD9//z/AwD/////AgD+//z/AwAAAP7/AQD///3/AgABAP3/AAAAAP3/AgACAPz///8BAP3/AQACAP3//v8BAP7/AAABAP3//v8CAP7///8BAP7//f8CAP////8AAAAA/v8CAAAAAAAAAAAA/v8BAAAAAAD//wAA//8AAP//AAD//wAA//8AAP//\",\n\"UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAAAAP//AAD//wAA//8AAAAA/////wAAAQD+////AAAGAP3/OAABAIIAAwBv//f/E/0QAK0ADQCzA/7/8P4u/0cBDQCJA6ABbQDg/w7/z/9o+Vn/SPnL/1//Ef+2+jr9RfZgA5QFZwILDFj+PAb2/nEFKgKk/R0Dlv6b/FUDsP6YAoj9SgAT/iL/tAPwAv8A0P6zAr7/dwAnAf39uP22/skA2v///2YCoP4UAUsAZgF2AJH+4P70/rz9+f+U/Xv/8v7CAcb+TACS/kwAv/+x/tX9oP71/oL/1f8nAEUAZwGtAAgAIgC/AD4BaP8GAGH/dQDF/64Arf8nAakAhAH9/+kAQQD3AFb/q/8p/yIAR/8FAPD/ZAA/AIYA3v8tADQADQBp/3f/CwABAP3/Wf8OANj/WwDH/xoAe/8DAKz/zv96/z8A3f/J/5X/IAD5//j/q//c/+//RADq//D/vv8pADUAFQDI/y8ACAAbANb/OwD3/+3/9f/e/wcAIAAeAMH/8/8xAC0AEADW/+3/HAADAPv/8P8DAOL/OwD3/xcACQAHAM//5f8XAAcAz//T/9D/HgD9////yf/e//v/AgD//9H/6/////H/+/8hAAIA9//7/w0AFgAQAPL/2v/8/xsAGQABANz/9P8YAAQA/v/y/wMA5v8YAAkAAAAAAAMA7/8KABgADwDs//j/BwATABsA8P/1//z/BAAMAAAA9P/s/xAA/v8GAAkA/v/p/wMACwALAP7/9P/p/wcADQAFAPb/7//4/w0ACAD8//b//v/1/wMACwD1//T/8P/8/wAACQDz/+f/5P8GAAkABQD5//D/+v8FAA0AAwD///T/AgACABAA/v8CAPD/+/8FAAoA9f/3//f//v8GAP7/9v/t//z/+f8AAPj/+v/3/wEA+v8HAPr//P/5/wQA//8DAPr/+P/3/wYA///+//X/+//5/wQA/f/7//X/+//4/wMA/f/8//j//v/9/wYA///8//f/AgAAAAUA/f/6//n/AwACAAIA/f/7//z/AwACAAAA/f/6//3/AgADAP7//f/7/wAAAwAFAPz////8/wMAAgAEAPv//v/+/wMAAgADAPv//v///wMAAQABAPv//f8AAAIAAAD///v//f8BAAIA///+//z//v8CAAIA/v/9//3///8CAAEA/v/9//7/AAACAAAA/v/9////AAABAAAA/f/9/wAAAQABAP///f/+/wEAAQAAAP///v/+/wEAAQD///7//v///wEAAQD///7//v///wEAAAD+//7///8AAAAAAAD+//7///8AAAAA///+//7///8AAAAA////////AAAAAP////////////8AAP//////////\",\n\"UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAAAAAAAAAABAAAAAAD//////////////v////3/////////+//8////AQD9//z/9f8BAAIA+f8dACgAWQBxAJX/qv+Y/uz9aP9k/7UDUQQBAiQA4Pgi/AkB0gKaBsD/+fxp/vz9CQSp/I/+ywDO+vMD0fzK/PABcgBeBfoBv/+uAuH9Sf5gAy39awMmBWUBuP9fA9/9fgDj/2/+EACaACcCSv9Z/2j/rv7hAA0AWf55/7L84P7E/SIAT/67AMv/tf+FAA7/1v+7/gv/IP+E/sQA+P5aAXz/tP9XAFX/tP8o/4r/j//e/yQAMv9mAJT/rgCr/9X/EwCb//H/9f7F/6D/EAAoAK3//v+e/zsAh/+B/7r/if/C/2r/4P/z/6//HwCy/0IA7/9ZALT/y/80ACgA9v/J/9//DgA5ADUALQARADIACwAfAOf/NgArACMACQBBAEcAGAAjAC4AWQBUAHcAAAAfACEAIAAcAPj/CADk/yQA7v89AEEAFwD5/xYA6f8aAOX/AADF/zQADwAUAOT/BQDr/yUA6P8XAOf/HADR/0AA8P8nAAgACQDt/ycAKAAHAPH/IQDz/xsACADn//n/DgADAA4A8P///8z/GgDN/yMA/f8QANj/MwACAC0ACwAOAO3/JgAZAAUACgAAAA4AIgAaAAkADwACAAAAHQATAAUABQACAAgACwAjAO////8AAA8ABQAPAPL//f8GAAsABgAGAPD/8v8GAPz/CAD6//H/6v8PAAgABgD4//3/9v8aAAgABwD1//7//v8QAAoACAD//wUA9v8QAAoABAAFAAgAAgAJAAoAAwD//w0AAgD//wcA/v8DAAoABQAFABUABAAKAAYABwAHAA8ACgAGAAwADwAMAAkAEAAJAAgADwAMAAgADgAJAAUACQAPAAUACwAHAAEABgAIAAEABAAGAP//AgAJAAAAAgAEAP7///8IAAIA//8GAAEAAQAJAAIA/v8EAAMA//8JAAEA/v8DAAMA/v8HAAMA/f8BAAUA/v8FAAMA/v8BAAcA//8DAAMA/v8BAAYA//8CAAMA/////wcAAAAAAAMAAAD//wYAAQD+/wMAAQD//wUAAQD+/wIAAgD//wQAAgD+/wEAAwD//wMAAwD+/wEAAwD//wIAAwD//wEABAAAAAEABAD//wAABAABAAAAAwAAAAAABAABAP//AwABAAAAAwACAP//AgACAAAAAwACAP//AgACAAAAAgACAAAAAQADAAAAAQACAAAAAQADAAAAAQACAAAAAAACAAEAAAACAAEAAAACAAEAAAABAAEAAAABAAEAAAABAAEAAAABAAEAAAABAAEAAAABAAEAAAAAAAAAAAAAAAAA\",\n\"UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAAAAP//AAD//wAA//8AAAAA//8AAP//AAACAAAA+f8BAAYA///4/wIA//8AAA8A/v/V/wEAEwA9AAEBRwA2AF7/kfog/3gBwv99CDYBU/qtAUX/AP7OAfkAX/o9B38FSfwaAuT14/60BAr8CQAI/tfyIQTzAXP+egdUBBwBof7TBMT8bAWi/5EEWwBRAAAKyfxE/8b88vp6ACP+PAF4/qD8MQNM/ygCJ/2XAPD9kP5gAVT/iP9I/lEB4P8qAD0BFAGa/+7/DgB2AOP98gFm/u/+Vv5/AG8ASP9gAM//qv9w//oAcv+2/jIBHgA7/6D/oAAGAKH/lADT/wAAggC8AAYAkP9yAEcAkf8BAOD/RAAr/zUANwDt/xQAJQAkAMT/zwA/AOH/xv9zAGsANQBTAIcALAAvACIATACy/xMADADg/xcAWABvAJL/7f9VAPb/EgDt/wcA4f8kAPP/5P+h/wgACQDy//r/LgAQAMn/8/9CAOX/5v/S/9//3P8pABYAuP/s/w8AFgDt/+3/7v/w/9j/5/8GAOf/2P/2//P//v8kABMAuf/m/xoADADZ/+r/3P8KAAUAKwDe/wsA3P8VAAAADgAfAB0ACAAMAF4AGgAhAPL/MwDz/0kABAAKAPX/LwAbAAkA9v/s/+3/8/8CABAAAADm//n/BQALAAUAAQDj//n/JQAVAPX/9v/+/wIAEQABAPP/8P/1/wAABgD6/+3/7//o//j/DAD8/+b/8P8IAAkABgD4//D/8P8UAAoAAwD4/wAA+f8OAAcAAAAFAPX/9v8TAAkA8v8EAPb/9/8dAA0A7/8CAPn/+f8SAAQA8/8CAOf/+v8DAAgA9P////H//P8IAAUA8//0/wIAAQAGAAgA9//7/wAA+/8EAP//+P/+////AgACAAsA8v/+/wIABQD7/wgA9v/7/wMABAD5/wAA/P/3/wEAAQD7//7//P/1/wQA///3//r////3/wMAAwD1//r/AwD6////AgD4//n/AwD8//7/AgD4//n/AwD+//3/AQD4//n/BQD///n/AAD6//j/BAABAPj/AAD9//v/AwADAPj//v/+//z/AwAEAPj//v8BAP7/AQADAPj//f8CAP////8EAPr//P8DAAAA/v8CAPv//P8DAAEA/f8BAP3//f8DAAIA/P8AAP7//f8DAAIA/P///wAA/f8BAAIA+//+/wEA//8AAAEA+//+/wEA/////wEA/P/+/wEA///+/wAA/f/9/wEAAAD9/wAA/f/+/wEAAQD8/////v/+/wAAAQD8////////////AQD9////AAD/////AAD+////AAAAAP//AAD///////8AAP//AAD//wAA//8AAP//\",\n];\n\nconst OmnitoneSOAHrirBase64 = [\n\"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/P////v//P8CAAQA+//+//3//f8CAAUA+v/9//////8AAAQA+v/8////AAD//wIA+//8/wAAAQD+/wEA+//8/wAAAgD9/////P/9/wEAAgD8//7//f/9/wAAAgD8//3//v/+////AQD8//z/////////AAD8//3///8AAP7/AAD9//7///8AAP7////+//////8AAP7////+////////////////////\",\n\"UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAD//////v8AAP///////wAAAAAAAP7/AQABAAAABwD///X/BQAjAPL/CQDb/9D/GAAb/7sAYwCW/z0BcP/X/7T/2QDW+wH8yANCCCUJ5QT++UXmhPwhA78FuAxH+p78ifudBlAG9vmu/lAK2fdlB///cfjoCa0E7Akn9Yb/zvba+AkAHPywBGEBFwUNAL8AXAAGA20DFvmR/kz+F/06Ag/+GwHl/5EEKgJd/q0AP/ym/9n6EfxY/2H+/QFtAC4C6QBDAaMCo/20/+3/3f/p/fL9rv9V/6cBhQHuAX4AcwJYAaH/IP/P/gsApP0LAe7/sQBuAI0AAgGDAE4BzACe/5X//v+v/+f+Zf+gAOv/5QBhAOIApAANASYAuP+h/8b/HQBr/9//bACWAGEAFAB5AD0AWQDU/+D/Yf/p//D/s/+R/4QAMQBvABEAkQBfABQAJgDW/wwA8/8XALz/vf8zAFAAKwD1/zEAPwDJ/x0A7/8LAOX/FwDR//H/EQAdAO//6P8QAFEA2f8WABEAMgDy/xIA+f/s/xAALgDv////HQAvAPT/+f8iAAYAEgAFABoAGgD//w0A+f/0/xsAHgDx/9f/GAACAPH/8f8JAPf/GwALABEA7/8cAPT/CgD2//j/BQD8/+3/OgAgAAYA9f8PAN7/DgD9/9r/1//3/+3/9//1//b/8//5//f/AgAJAOf/+v8OAAMACwD9/+7/5f8eAAEA9//q//7/8P8WAP7/+//4/wIA+f8TAAIA9f/5/wcA+P8iAAgA9v/n/xoA//8gAAUABwDj/wAA9v8BAAUAFQDn/wMA7v8QABAAEQDm/wwA8f8aAAAABwDu/wcACgASAAEA7//w//f/BgARAAkA6P/3/wcADgAKAAYA4f/4/wYADgAAAPr/8P/9/xQACgAHAPn/7//9/xEAAgD+//L/8v/8/xUAAwDw//H/9f8CAAsA/v/q//L/+f8FAAYA/P/r//j///8GAAkA+//o//j/AQAIAP//+v/o//v/CAAIAPv/+P/w/wEACQAHAPj/+f/0/wIACwAFAPb/+f/4/wQACwACAPP/+f/+/wYACAD///L/+/8BAAYABQD9//P//P8FAAUAAgD7//T//f8HAAQA///7//f///8IAAMA/P/6//r/AQAIAAEA+v/6//3/AgAHAAAA+f/7/wAAAwAFAP7/+P/8/wIAAgACAP3/+f/9/wMAAwAAAPz/+v/+/wQAAgD+//z/+/8AAAQAAQD8//z//f8BAAQAAAD7//3///8BAAMA///7//3/AAACAAEA/v/7//7/AQABAAAA/v/9////AQAAAP///v/+////AAD/////////////////////////////\",\n\"UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAD////////+//////8AAAAA/v/+/wAAAQD8//3/CQAJAP3/+v8PAAcApABlABkBkwCO/i//lfqa/HQAcf/3BdkCzwJcBCMC0wMN/9/9wgI7AaECYfxV/Tf83vhn/xrt8Owx/8n7cgHABYb43QcZDh4WugNrA7P74gHu/9z/zv0t/acCiQHY/iv4qQOl/ysCE/0//XT9Sf4O//j9xfupAn394gHO+rsCXAFIAxQC9wIXBgcD2AQuAnb/9gJh/6wAVfxEAI4Bvf7oAFv/bALsAMQBe/88/joAT/4dAH39/v9LAXn/gwDI//QBdABcAA0A7f4lAMn///+9/tv/iABp/13/pP/dALv/w/8MAHv//f+y/6////7U/5AAZP+Z/8r/nQDR/5r/DwDr/xAA4v+s/3z/+P9uAOv/t/82AGcAHgCb/yQAFQBGAM7/CgD3/xoAegAaAOz/CgBHAA8Adv8/AAAABQC2/xIAAAA7ABQAKgCj/z4AAQAXAJz/JAADAAcA8f/1/2AAAQAlAPD/NgDx/1wA7v/4/wMAZADv//3/HQAkAFoA8P9FAPv/FgBIAPf/WQAHAEUACQD0/xIAQwDu/wMAwP9VALn/XwCw/yEA5f8sAPj/FgDD/1YAyv8rAOX/HQDo//j/IQAQACAAHwD9/yQAHQBAABgABQAiAAUAKAD3/wkACwAKAAMABwAJAPb/+f8GAOr/JQAHABMA6P8TAA4AGgD//woA8/8ZAP//GADu/w0A9v8SAAMABwD4/wQA5P8XAAQACgDq/wUA+/8VAAcACADs/xIAAAATAPH/+v/1//T/7f///+z/+v/y/+//9/8KAAcACgAJAPT/BAAKAAAABgAIAPL/9v8KAAMABAACAPr/9v8OAAIA+P/x//v/+f8MAPb/+P/w/wQA9f8MAPn////7/woA/v8PAAEAAgD1/xAAAQAPAP//AwD//xQABwALAAAABgADABAAAgAHAAAACAABAA8ABQAFAAMABwAEAA4ABwADAAEACQAFAAoAAwD//wAACQADAAUAAQD/////CAABAAMAAAD/////BwACAAEAAAD/////BwACAP7///8BAAAABgABAP7///8CAAAABAAAAP7///8DAAAAAwAAAP3///8DAAAAAQAAAP3//v8EAAAAAAD+//////8EAP/////+/wAA/v8EAP/////+/wEA/v8EAP///v/+/wIA//8DAP///v/+/wIA//8BAP///v/+/wMA//8BAP/////+/wMA//8AAP//AAD+/wQA//8AAP7/AQD//wIA////////AQD//wIA////////AQAAAAEAAAAAAP//AQD//wEAAAAAAP//AQAAAAEAAAAAAAAA\",\n\"UklGRiQEAABXQVZFZm10IBAAAAABAAIAgLsAAADuAgAEABAAZGF0YQAEAAD+/wAA+v8AAPz/AAD//wAA/f8AAAEAAAD+/wAACQAAAAQAAAAZAAAAtgAAAFsBAABW/gAAH/oAAGcBAABoBwAAlAAAAO3/AAARAQAA+wIAAEoEAACe/gAAiv4AALD0AADJ8wAAkQQAAF34AABi8QAAPQAAAAH2AAD19AAADAMAAJwGAACTEAAA0AwAAJkHAACOBwAAuQEAANcDAAC6AgAAHwUAAHEFAAB0AwAAbgEAADz+AADYAQAAGAAAAJwCAADgAAAA//0AAMn+AAAT/AAAwP8AAOn9AAAJAAAAewEAAOn+AACN/wAAOv0AAO3+AADN/gAAcP8AACj/AACq/gAA+f4AAML9AACa/wAA/f4AAN7/AABo/wAA6/4AAE//AAAC/wAAEQAAAHX/AAB0AAAA5f8AAEwAAAB3AAAA5/8AAMIAAABCAAAAzgAAAE8AAAB3AAAAKAAAADMAAACqAAAALwAAAK4AAAASAAAAVgAAACgAAAAtAAAATAAAAP3/AAA7AAAA2/8AACQAAADw/wAALQAAADEAAAAlAAAAbAAAADMAAABUAAAAEAAAACgAAAD1/wAA9v8AAPr/AADu/wAALgAAABIAAABUAAAARAAAAGUAAABGAAAAOAAAAGAAAAAuAAAARQAAACEAAAAfAAAAAAAAAAkAAAAQAAAAAwAAABIAAADs/wAAEAAAAAYAAAASAAAAIgAAABEAAAADAAAABAAAAA8AAAD4/wAAHQAAAAsAAAAIAAAADgAAAP//AAAcAAAADwAAAAYAAAASAAAAFwAAAAMAAAAYAAAAEgAAAPr/AAAQAAAADQAAAAoAAAD3/wAABgAAAPb/AADf/wAA/v8AAPL/AAD6/wAAFAAAAAQAAAAEAAAAGwAAAAEAAAAMAAAAIAAAAAIAAAAdAAAAGAAAAAIAAAAcAAAAEgAAAAcAAAAeAAAADwAAAAQAAAAeAAAABAAAAAYAAAAZAAAAAQAAAA4AAAATAAAA/v8AAAoAAAAOAAAA+/8AAAsAAAAJAAAA+f8AAAsAAAABAAAA+f8AAAoAAAD9/wAA+v8AAAcAAAD5/wAA+v8AAAUAAAD3/wAA/f8AAAQAAAD2/wAAAAAAAAEAAAD3/wAAAgAAAAAAAAD4/wAAAwAAAP7/AAD6/wAABAAAAP3/AAD8/wAABAAAAPv/AAD+/wAAAwAAAPv/AAD//wAAAQAAAPv/AAAAAAAAAAAAAPv/AAACAAAA//8AAPz/AAACAAAA/v8AAP3/AAACAAAA/f8AAP7/AAABAAAA/f8AAP//AAABAAAA/f8AAAAAAAAAAAAA/v8AAAEAAAAAAAAA//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\n];\n\nconst RenderingMode$1 = {\n  AMBISONIC: 'ambisonic',\n  BYPASS: 'bypass',\n  OFF: 'off',\n};\nconst SupportedAmbisonicOrder = [2, 3];\nfunction HOARenderer(context, config) {\n  this._context = Utils.isAudioContext(context) ?\n      context :\n      Utils.throw('HOARenderer: Invalid BaseAudioContext.');\n  this._config = {\n    ambisonicOrder: 3,\n    renderingMode: RenderingMode$1.AMBISONIC,\n  };\n  if (config && config.ambisonicOrder) {\n    if (SupportedAmbisonicOrder.includes(config.ambisonicOrder)) {\n      this._config.ambisonicOrder = config.ambisonicOrder;\n    } else {\n      Utils.log(\n          'HOARenderer: Invalid ambisonic order. (got ' +\n          config.ambisonicOrder + ') Fallbacks to 3rd-order ambisonic.');\n    }\n  }\n  this._config.numberOfChannels =\n      (this._config.ambisonicOrder + 1) * (this._config.ambisonicOrder + 1);\n  this._config.numberOfStereoChannels =\n      Math.ceil(this._config.numberOfChannels / 2);\n  if (config && config.hrirPathList) {\n    if (Array.isArray(config.hrirPathList) &&\n        config.hrirPathList.length === this._config.numberOfStereoChannels) {\n      this._config.pathList = config.hrirPathList;\n    } else {\n      Utils.throw(\n          'HOARenderer: Invalid HRIR URLs. It must be an array with ' +\n          this._config.numberOfStereoChannels + ' URLs to HRIR files.' +\n          ' (got ' + config.hrirPathList + ')');\n    }\n  }\n  if (config && config.renderingMode) {\n    if (Object.values(RenderingMode$1).includes(config.renderingMode)) {\n      this._config.renderingMode = config.renderingMode;\n    } else {\n      Utils.log(\n          'HOARenderer: Invalid rendering mode. (got ' +\n          config.renderingMode + ') Fallbacks to \"ambisonic\".');\n    }\n  }\n  this._buildAudioGraph();\n  this._isRendererReady = false;\n}\nHOARenderer.prototype._buildAudioGraph = function() {\n  this.input = this._context.createGain();\n  this.output = this._context.createGain();\n  this._bypass = this._context.createGain();\n  this._hoaRotator = new HOARotator(this._context, this._config.ambisonicOrder);\n  this._hoaConvolver =\n      new HOAConvolver(this._context, this._config.ambisonicOrder);\n  this.input.connect(this._hoaRotator.input);\n  this.input.connect(this._bypass);\n  this._hoaRotator.output.connect(this._hoaConvolver.input);\n  this._hoaConvolver.output.connect(this.output);\n  this.input.channelCount = this._config.numberOfChannels;\n  this.input.channelCountMode = 'explicit';\n  this.input.channelInterpretation = 'discrete';\n};\nHOARenderer.prototype._initializeCallback = function(resolve, reject) {\n  let bufferList;\n  if (this._config.pathList) {\n    bufferList =\n        new BufferList(this._context, this._config.pathList, {dataType: 'url'});\n  } else {\n    bufferList = this._config.ambisonicOrder === 2\n        ? new BufferList(this._context, OmnitoneSOAHrirBase64)\n        : new BufferList(this._context, OmnitoneTOAHrirBase64);\n  }\n  bufferList.load().then(\n      function(hrirBufferList) {\n        this._hoaConvolver.setHRIRBufferList(hrirBufferList);\n        this.setRenderingMode(this._config.renderingMode);\n        this._isRendererReady = true;\n        Utils.log('HOARenderer: HRIRs loaded successfully. Ready.');\n        resolve();\n      }.bind(this),\n      function() {\n        const errorMessage = 'HOARenderer: HRIR loading/decoding failed.';\n        reject(errorMessage);\n        Utils.throw(errorMessage);\n      });\n};\nHOARenderer.prototype.initialize = function() {\n  Utils.log(\n      'HOARenderer: Initializing... (mode: ' + this._config.renderingMode +\n      ', ambisonic order: ' + this._config.ambisonicOrder + ')');\n  return new Promise(this._initializeCallback.bind(this));\n};\nHOARenderer.prototype.setRotationMatrix3 = function(rotationMatrix3) {\n  if (!this._isRendererReady) {\n    return;\n  }\n  this._hoaRotator.setRotationMatrix3(rotationMatrix3);\n};\nHOARenderer.prototype.setRotationMatrix4 = function(rotationMatrix4) {\n  if (!this._isRendererReady) {\n    return;\n  }\n  this._hoaRotator.setRotationMatrix4(rotationMatrix4);\n};\nHOARenderer.prototype.setRenderingMode = function(mode) {\n  if (mode === this._config.renderingMode) {\n    return;\n  }\n  switch (mode) {\n    case RenderingMode$1.AMBISONIC:\n      this._hoaConvolver.enable();\n      this._bypass.disconnect();\n      break;\n    case RenderingMode$1.BYPASS:\n      this._hoaConvolver.disable();\n      this._bypass.connect(this.output);\n      break;\n    case RenderingMode$1.OFF:\n      this._hoaConvolver.disable();\n      this._bypass.disconnect();\n      break;\n    default:\n      Utils.log(\n          'HOARenderer: Rendering mode \"' + mode + '\" is not ' +\n          'supported.');\n      return;\n  }\n  this._config.renderingMode = mode;\n  Utils.log('HOARenderer: Rendering mode changed. (' + mode + ')');\n};\n\nconst Polyfill = {};\nPolyfill.getBrowserInfo = function() {\n  const ua = navigator.userAgent;\n  let M = ua.match(\n      /(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*([\\d\\.]+)/i) ||\n      [];\n  let tem;\n  if (/trident/i.test(M[1])) {\n    tem = /\\brv[ :]+(\\d+)/g.exec(ua) || [];\n    return {name: 'IE', version: (tem[1] || '')};\n  }\n  if (M[1] === 'Chrome') {\n    tem = ua.match(/\\bOPR|Edge\\/(\\d+)/);\n    if (tem != null) {\n      return {name: 'Opera', version: tem[1]};\n    }\n  }\n  M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];\n  if ((tem = ua.match(/version\\/([\\d.]+)/i)) != null) {\n    M.splice(1, 1, tem[1]);\n  }\n  let platform = ua.match(/android|ipad|iphone/i);\n  if (!platform) {\n    platform = ua.match(/cros|linux|mac os x|windows/i);\n  }\n  return {\n    name: M[0],\n    version: M[1],\n    platform: platform ? platform[0] : 'unknown',\n  };\n};\nPolyfill.patchSafari = function() {\n  if (window.webkitAudioContext && window.webkitOfflineAudioContext) {\n    window.AudioContext = window.webkitAudioContext;\n    window.OfflineAudioContext = window.webkitOfflineAudioContext;\n  }\n};\n\nconst Version = '1.3.0';\n\nconst Omnitone = {};\nOmnitone.browserInfo = Polyfill.getBrowserInfo();\nOmnitone.createBufferList = function(context, bufferData, options) {\n  const bufferList =\n      new BufferList(context, bufferData, options || {dataType: 'url'});\n  return bufferList.load();\n};\nOmnitone.mergeBufferListByChannel = Utils.mergeBufferListByChannel;\nOmnitone.splitBufferbyChannel = Utils.splitBufferbyChannel;\nOmnitone.createFOAConvolver = function(context, hrirBufferList) {\n  return new FOAConvolver(context, hrirBufferList);\n};\nOmnitone.createFOARouter = function(context, channelMap) {\n  return new FOARouter(context, channelMap);\n};\nOmnitone.createFOARotator = function(context) {\n  return new FOARotator(context);\n};\nOmnitone.createHOARotator = function(context, ambisonicOrder) {\n  return new HOARotator(context, ambisonicOrder);\n};\nOmnitone.createHOAConvolver = function(\n    context, ambisonicOrder, hrirBufferList) {\n  return new HOAConvolver(context, ambisonicOrder, hrirBufferList);\n};\nOmnitone.createFOARenderer = function(context, config) {\n  return new FOARenderer(context, config);\n};\nOmnitone.createHOARenderer = function(context, config) {\n  return new HOARenderer(context, config);\n};\n(function() {\n  Utils.log(`Version ${Version} (running ${Omnitone.browserInfo.name} \\\n${Omnitone.browserInfo.version} on ${Omnitone.browserInfo.platform})`);\n  if (Omnitone.browserInfo.name.toLowerCase() === 'safari') {\n    Polyfill.patchSafari();\n    Utils.log(`${Omnitone.browserInfo.name} detected. Polyfill applied.`);\n  }\n})();\n\nexport default Omnitone;\n","/* global DEBUG */\n\nlet log;\nlet warn;\n\nconst AFRAME = window.AFRAME;\nif (typeof DEBUG !== 'undefined' && DEBUG && AFRAME) {\n\tlog = AFRAME.utils.debug('components:ambisonic:info');\n\twarn = AFRAME.utils.debug('components:ambisonic:warn');\n} else {\n\tlog = warn = () => {};\n}\n\nexport { log, warn };","import Omnitone from 'omnitone/build/omnitone.esm';\n// import * as AFRAME from 'aframe';\n// import * as THREE from 'three';\nconst AFRAME = window.AFRAME;\nconst THREE = window.THREE; // imported by aframe\nimport { log, warn } from './log';\n\nfunction setBooleanAttribute(element, attr, value) {\n\tif (element) {\n\t\tif (value) {\n\t\t\telement.setAttribute(attr, true);\n\t\t} else {\n\t\t\telement.removeAttribute(attr);\n\t\t}\n\t}\n}\n\nconst MIN_ORDER = 1;\nconst MAX_ORDER = 3;\nconst isSafari = false;// /safari/i.test(Omnitone.browserInfo.name);\nconst isIOS = false;// /iP(ad|od|hone)/.test(Omnitone.browserInfo.platform);\nconst safariChannelMap = ([w, x, y, z]) => [y, w, x, z];\n\nfunction setRotationMatrixFromCamera(renderer, camera) {\n\trenderer.setRotationMatrix4(camera.matrixWorldInverse.elements);\n}\n\nfunction channelCount(order) {\n\tconst orderPlus1 = order + 1;\n\treturn orderPlus1 * orderPlus1;\n}\n\nconst boundMethods = [\n\t'setCamera',\n\t'onEntityChange',\n\t'onLoadSound',\n\t'onPlaySound',\n\t'onPauseSound',\n\t'onEndSound'\n];\n\nconst channelMapSchemes = {\n\t// acn: n => n,\n\tsid: [\n\t\t0,  3,  1,  2,\n\t\t8,  4,  7,  5,\n\t\t6, 15,  9, 14,\n\t\t10, 13, 11, 12\n\t],\n\tfuma: [\n\t\t0,  3,  1,  2,\n\t\t6,  7,  5,  8,\n\t\t4, 12, 13, 11,\n\t\t14, 10, 15,  9\n\t]\n};\nconst intArrayRegex = /^([0-9]+)(\\s*,\\s*([0-9]+))*$/;\n\nAFRAME.registerComponent('ambisonic', {\n\tschema: {\n\t\tsrc: { type: 'audio' },\n\t\tsources: { type: 'array', default: [] },\n\t\tloop: { type: 'boolean', default: true },\n\t\tautoplay: { type: 'boolean', default: false },\n\t\tuseMediaElement: { type: 'boolean', default: true },\n\t\torder: { type: 'number', default: 1 },\n\t\tchannelMap: {\n\t\t\tparse: str => {\n\t\t\t\tif (typeof str === 'string') {\n\t\t\t\t\tstr = str.trim().toLowerCase();\n\t\t\t\t}\n\t\t\t\tif (channelMapSchemes[str]) {\n\t\t\t\t\treturn channelMapSchemes[str];\n\t\t\t\t}\n\n\t\t\t\tif (intArrayRegex.test(str)) {\n\t\t\t\t\treturn str.split(',').map(parseFloat);\n\t\t\t\t}\n\n\t\t\t\treturn [];\n\t\t\t},\n\t\t\tstringify: value => {\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\treturn value.join(', ');\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tdefault: 'ACN'\n\t\t},\n\t\tmode: {\n\t\t\tdefault: 'ambisonic',\n\t\t\toneOf: [\n\t\t\t\t'bypass',\n\t\t\t\t'ambisonic',\n\t\t\t\t'off'\n\t\t\t]\n\t\t}\n\t},\n\n\tinit() {\n\t\tthis.context = null;\n\t\tthis.renderer = null;\n\t\tthis.audio = null;\n\t\tthis.mediaElement = null;\n\t\tthis.audioSources = [];\n\t\tthis.loading = false;\n\n\t\tthis.ownMediaElement = false;\n\t\tthis.playing = false;\n\n\t\t// bind any event handling methods\n\t\tboundMethods.forEach(name => {\n\t\t\tthis[name] = this[name].bind(this);\n\t\t});\n\n\t\t// Update on entity change.\n\t\tthis.el.addEventListener('componentchanged', this.onEntityChange);\n\t},\n\n\tupdate(oldData) {\n\t\tconst el = this.el;\n\t\tconst sceneEl = el.sceneEl;\n\t\t// todo: handle changed scene element\n\n\t\t// try to get context from scene audio listener. otherwise, make our own\n\t\tconst listener = sceneEl.audioListener;\n\t\tconst context = listener && listener.context || this.context || THREE.AudioContext.getContext();\n\n\t\t// Wait for camera if necessary.\n\t\tthis.camera = sceneEl.camera || null;\n\t\tsceneEl.addEventListener('camera-set-active', this.setCamera);\n\n\t\t// if context changed, then need to rebuild omnitone instance\n\t\t// todo: rebuild if type of Omnitone renderer (order) changed\n\t\tconst {\n\t\t\torder,\n\t\t\tsrc,\n\t\t\tsources\n\t\t} = this.data;\n\n\t\tconst channels = channelCount(order);\n\t\tconst useMediaElement = this.data.useMediaElement &&\n\t\t\t(!sources || !(sources.length >= 2));\n\n\t\tconst rebuildOmnitone = context !== this.context ||\n\t\t\t!this.renderer ||\n\t\t\tthis.renderer.input.channelCount > 4 !== channels >= 4;\n\n\t\tif (rebuildOmnitone) {\n\t\t\tthis.context = context;\n\t\t\tthis.resumeAudioContext();\n\n\t\t\tif (this.renderer) {\n\t\t\t\t// clean up old renderer\n\t\t\t\tthis.renderer.output.disconnect();\n\t\t\t\tthis.renderer = null;\n\t\t\t}\n\n\t\t\tconst createRenderer = channels === 4 ?\n\t\t\t\tOmnitone.createFOARenderer :\n\t\t\t\tOmnitone.createHOARenderer;\n\n\t\t\tconst renderer = this.renderer = createRenderer(this.context, { ambisonicOrder: order });\n\n\t\t\trenderer.initialize().then(() => {\n\t\t\t\tif (renderer !== this.renderer || context !== this.context) {\n\t\t\t\t\t// things changed while we were initializing so abort\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.audio.gain.connect(this.renderer.input);\n\t\t\t\trenderer.output.connect(context.destination);\n\n\t\t\t\tthis.updateAmbisonicSettings();\n\t\t\t});\n\n\t\t\tthis.audio = new THREE.Audio(listener || {\n\t\t\t\tcontext,\n\t\t\t\tgetInput: () => context.destination\n\t\t\t});\n\t\t\tthis.audio.gain.disconnect();\n\t\t}\n\n\t\tconst rebuildSound = rebuildOmnitone ||\n\t\t\t!!oldData.useMediaElement !== !!useMediaElement ||\n\t\t\toldData.src !== src ||\n\t\t\tJSON.stringify(oldData.sources) !== JSON.stringify(sources);\n\n\t\tif (rebuildSound) {\n\t\t\tif (useMediaElement) {\n\t\t\t\tlet newMediaElement = null;\n\t\t\t\tif (src instanceof window.HTMLMediaElement) {\n\t\t\t\t\tnewMediaElement = src;\n\t\t\t\t\tthis.ownMediaElement = false;\n\t\t\t\t} else if (src) {\n\t\t\t\t\tnewMediaElement = document.createElement('audio');\n\t\t\t\t\tnewMediaElement.src = src;\n\t\t\t\t\t// this.mediaElement.load();\n\t\t\t\t\tthis.ownMediaElement = true;\n\t\t\t\t}\n\t\t\t\tif (this.mediaElement !== newMediaElement) {\n\t\t\t\t\tthis.cleanMediaAssets();\n\t\t\t\t}\n\t\t\t\tif (newMediaElement) {\n\t\t\t\t\tnewMediaElement.addEventListener('play', this.onPlaySound);\n\t\t\t\t\tnewMediaElement.addEventListener('pause', this.onPauseSound);\n\t\t\t\t\tnewMediaElement.addEventListener('load', this.onLoadSound);\n\t\t\t\t\tnewMediaElement.addEventListener('canplay', this.onLoadSound);\n\t\t\t\t\tnewMediaElement.addEventListener('ended', this.onEndSound);\n\t\t\t\t}\n\n\t\t\t\tif (!this.mediaElement && newMediaElement && this.ownMediaElement) {\n\t\t\t\t\tnewMediaElement.onerror = evt => {\n\t\t\t\t\t\twarn('Error loading audio', src, evt);\n\t\t\t\t\t};\n\t\t\t\t\tnewMediaElement.onloadedmetadata = () => {\n\t\t\t\t\t\tlog('Audio metadata loaded', src, this.mediaElement);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthis.mediaElement = newMediaElement;\n\t\t\t\tthis.audioSources = [];\n\t\t\t\tif (this.mediaElement) {\n\t\t\t\t\tthis.audio.setMediaElementSource(this.mediaElement);\n\t\t\t\t} else if (this.audio.source) {\n\t\t\t\t\tthis.audio.disconnect();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// load audio buffer\n\n\t\t\t\tlet url = src;\n\t\t\t\tif (src && typeof src !== 'string' && src instanceof window.HTMLMediaElement) {\n\t\t\t\t\tif (src.tagName.toLowerCase() === 'video') {\n\t\t\t\t\t\tthrow new Error('Unable to load video as audio buffer');\n\t\t\t\t\t}\n\t\t\t\t\turl = src.src || src.srcObject || src.currentSrc;\n\t\t\t\t}\n\n\t\t\t\tif (sources && sources.length) {\n\t\t\t\t\tthis.audioSources = sources;\n\t\t\t\t} else {\n\t\t\t\t\tthis.audioSources = [url];\n\t\t\t\t}\n\t\t\t\tthis.cleanMediaAssets();\n\t\t\t\tif (this.data.autoplay) {\n\t\t\t\t\tthis.loadBuffer();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.updatePlaybackSettings();\n\t\tthis.updateAmbisonicSettings();\n\t},\n\n\ttick() {\n\t\tif (this.renderer && this.camera) {\n\t\t\tsetRotationMatrixFromCamera(this.renderer, this.camera);\n\t\t}\n\t},\n\n\tplay() {\n\t\tif (this.data.autoplay) {\n\t\t\tthis.playSound();\n\t\t}\n\t},\n\n\tpause() {\n\t\tthis.pauseSound();\n\t},\n\n\tcleanMediaAssets() {\n\t\t// clean up all sound assets\n\t\tif (this.mediaElement) {\n\t\t\tthis.mediaElement.removeEventListener('play', this.playSound);\n\t\t\tthis.mediaElement.removeEventListener('pause', this.onPauseSound);\n\t\t\tthis.mediaElement.removeEventListener('load', this.onLoadSound);\n\t\t\tthis.mediaElement.removeEventListener('canplay', this.onLoadSound);\n\t\t\tthis.mediaElement.removeEventListener('ended', this.onEndSound);\n\t\t\tif (this.ownMediaElement) {\n\t\t\t\tthis.mediaElement.pause();\n\t\t\t\tthis.mediaElement.src = '';\n\t\t\t\tthis.mediaElement.load();\n\t\t\t}\n\t\t\tthis.mediaElement = null;\n\t\t}\n\t\tif (this.audio) {\n\t\t\tif (this.audio.isPlaying) {\n\t\t\t\tthis.audio.stop();\n\t\t\t}\n\t\t\tif (this.audio.source) {\n\t\t\t\tthis.audio.source.removeEventListener('ended', this.onEndSound);\n\t\t\t}\n\t\t\tthis.audio.source = null;\n\t\t\tthis.audio.buffer = null;\n\t\t\tthis.audio.sourceType = 'empty';\n\t\t}\n\t\tif (this.loading) {\n\t\t\t// todo: find a way to abort loader\n\t\t\tthis.loading = false;\n\t\t}\n\t},\n\n\tremove() {\n\t\tconst el = this.el;\n\t\tconst sceneEl = el && el.sceneEl;\n\t\tif (sceneEl) {\n\t\t\tsceneEl.removeEventListener('camera-set-active', this.setCamera);\n\t\t}\n\t\tthis.el.removeEventListener('componentchanged', this.onEntityChange);\n\t\tthis.disconnect();\n\t\tthis.cleanMediaAssets();\n\t},\n\n\tsetCamera(evt) {\n\t\tthis.camera = evt.detail.cameraEl.getObject3D('camera');\n\t},\n\n\t// resume audio context\n\tresumeAudioContext() {\n\t\tif (this.context && this.context.resume && this.context.state === 'suspended') {\n\t\t\treturn this.context.resume().catch(() => {});\n\t\t}\n\n\t\treturn Promise.resolve();\n\t},\n\n\tloadBuffer() {\n\t\tthis.resumeAudioContext().then(() => {\n\t\t\tif (this.loading || !this.audioSources.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.loading = true;\n\t\t\tconst sources = JSON.stringify(this.audioSources);\n\t\t\tOmnitone.createBufferList(this.context, this.audioSources)\n\t\t\t\t.then(results => {\n\t\t\t\t\tconst audioBuffer = Omnitone.mergeBufferListByChannel(this.context, results);\n\t\t\t\t\tconst useMediaElement = this.data.useMediaElement && (!sources || !(sources.length >= 2));\n\t\t\t\t\tif (!useMediaElement && sources === JSON.stringify(this.audioSources)) {\n\t\t\t\t\t\tthis.audio.setBuffer(audioBuffer);\n\t\t\t\t\t\tthis.onLoadSound();\n\t\t\t\t\t\tthis.updatePlaybackSettings();\n\t\t\t\t\t\tif (this.playing) {\n\t\t\t\t\t\t\tthis.playSound();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\twarn('Unable to decode audio source', this.audioSources, error);\n\t\t\t\t});\n\t\t});\n\t},\n\n\t// set play state to start when loaded\n\tplaySound() {\n\t\tthis.playing = true;\n\t\tthis.resumeAudioContext();\n\t\tif (this.mediaElement) {\n\t\t\tconst playPromise = this.mediaElement.play();\n\t\t\tif (playPromise) {\n\t\t\t\tplayPromise.catch(e => {\n\t\t\t\t\twarn('Unable to play media', e.message);\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (this.audio && !this.audio.isPlaying) {\n\t\t\tthis.loadBuffer();\n\t\t\tif (this.audio.buffer) {\n\t\t\t\tthis.audio.play();\n\t\t\t\tthis.audio.source.addEventListener('ended', this.onEndSound);\n\t\t\t\tthis.onPlaySound();\n\t\t\t}\n\t\t}\n\t},\n\n\tpauseSound() {\n\t\tthis.playing = false;\n\t\tif (this.mediaElement) {\n\t\t\tthis.mediaElement.pause();\n\t\t} else if (this.audio && this.audio.isPlaying) {\n\t\t\tthis.audio.pause();\n\t\t\tthis.onPauseSound();\n\t\t}\n\t},\n\n\tstopSound() {\n\t\tif (this.mediaElement) {\n\t\t\tthis.mediaElement.pause();\n\t\t} else if (this.audio) {\n\t\t\tthis.audio.stop();\n\t\t\tthis.onPauseSound();\n\t\t}\n\t},\n\n\tonPlaySound() {\n\t\tthis.resumeAudioContext();\n\t\tthis.el.emit('sound-play');\n\t},\n\n\tonPauseSound() {\n\t\tthis.el.emit('sound-pause');\n\t},\n\n\tonLoadSound() {\n\t\tthis.el.emit('sound-loaded');\n\t},\n\n\tonEndSound() {\n\t\tif (this.audio && this.audio.source) {\n\t\t\tthis.onPauseSound();\n\t\t\tthis.audio.source.removeEventListener('ended', this.onEndSound);\n\t\t}\n\t\tthis.el.emit('sound-ended');\n\t},\n\n\t/**\n\t* Update the Omnitone sound settings.\n\t*/\n\tupdateAmbisonicSettings() {\n\t\tif (this.renderer) {\n\t\t\tif (this.renderer.setChannelMap) {\n\t\t\t\tconst channelMap = this.data.channelMap.slice(0);\n\n\t\t\t\t// fill in any missing channel map values in case they're left out\n\t\t\t\tconst channels = channelCount(this.data.order);\n\t\t\t\tfor (let i = channelMap.length; i < channels; i++) {\n\t\t\t\t\tchannelMap[i] = i;\n\t\t\t\t}\n\t\t\t\tchannelMap.length = channels;\n\n\t\t\t\t/*\n\t\t\t\tPer various documents on the internet, Safari messes up the\n\t\t\t\torder of the channels, but that does not seem to be the case.\n\t\t\t\tMaybe it's been fixed in a recent version, so this is disabled\n\t\t\t\tfor now.\n\t\t\t\t*/\n\t\t\t\tthis.renderer.setChannelMap(\n\t\t\t\t\tchannelMap.length === 4 && isSafari ?\n\t\t\t\t\t\tsafariChannelMap(channelMap) :\n\t\t\t\t\t\tchannelMap\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Mobile Safari cannot decode all the audio channels from a media element\n\t\t\tconst { order, mode } = this.data;\n\t\t\tconst validOrder = order >= MIN_ORDER && order <= MAX_ORDER;\n\t\t\tconst renderingMode = (isIOS || !validOrder) && mode === 'ambisonic' ?\n\t\t\t\t'bypass' :\n\t\t\t\tthis.data.mode;\n\t\t\tthis.renderer.setRenderingMode(renderingMode);\n\t\t}\n\t},\n\n\t/**\n\t* Update the playback settings.\n\t*/\n\tupdatePlaybackSettings() {\n\t\tif (this.mediaElement) {\n\n\t\t\t// only if we created this element\n\t\t\tif (this.ownMediaElement) {\n\t\t\t\tsetBooleanAttribute(this.mediaElement, 'loop', this.data.loop);\n\t\t\t\tsetBooleanAttribute(this.mediaElement, 'autoplay', this.data.autoplay);\n\t\t\t}\n\t\t} else if (this.audio) {\n\t\t\tthis.audio.setLoop(this.data.loop);\n\t\t\tthis.audio.autoplay = this.data.autoplay;\n\t\t}\n\t\t// todo: other props like playbackRate, detune, etc.\n\t},\n\n\n\t/**\n\t* When the entity's rotation is changed, update the Omnitone rotation accordingly.\n\t* @param {Event} evt\n\t*/\n\tonEntityChange(evt) {\n\t\tif (evt.detail.name !== 'rotation') {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.el.sceneEl.object3D.updateMatrixWorld(true);\n\t\t// todo: support rotating entity\n\t},\n\n\tdisconnect() {\n\t\tif (this.audio) {\n\t\t\tthis.audio.disconnect();\n\t\t\tthis.audio.gain.disconnect();\n\t\t}\n\t\tif (this.renderer) {\n\t\t\tthis.renderer.input.disconnect();\n\t\t\tthis.renderer.output.disconnect();\n\t\t}\n\t}\n});\n\nAFRAME.registerPrimitive('a-ambisonic', {\n\tdefaultComponents: {\n\t\t'ambisonic': {}\n\t},\n\tmappings: {\n\t\tsrc: 'ambisonic.src',\n\t\tsources: 'ambisonic.sources',\n\t\tloop: 'ambisonic.loop',\n\t\tautoplay: 'ambisonic.autoplay',\n\t\torder: 'ambisonic.order',\n\t\t'use-media-element': 'ambisonic.useMediaElement',\n\t\t'channel-map': 'ambisonic.channelMap',\n\t\tmode: 'ambisonic.mode'\n\t}\n});\n"],"sourceRoot":""}